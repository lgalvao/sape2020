{"remainingRequest":"/Users/leonardo/sape2020/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/leonardo/sape2020/src/views/VisaoZonasFila.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/leonardo/sape2020/src/views/VisaoZonasFila.vue","mtime":1598581088056},{"path":"/Users/leonardo/sape2020/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/leonardo/sape2020/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leonardo/sape2020/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcEFjdGlvbnMsIG1hcEdldHRlcnMsIG1hcE11dGF0aW9ucywgbWFwU3RhdGV9IGZyb20gJ3Z1ZXgnDQppbXBvcnQgKiBhcyB0aXBvcyBmcm9tICcuLi9zdG9yZS9tdXRhdGlvbnR5cGVzJw0KDQppbXBvcnQgTmF2ZWdhY2FvIGZyb20gJy4uL2NvbXBvbmVudGVzL05hdmVnYWNhbycNCmltcG9ydCBMZWdlbmRhIGZyb20gJy4uL2NvbXBvbmVudGVzL0xlZ2VuZGEnDQppbXBvcnQgbG9kYXNoIGZyb20gJ2xvZGFzaCcNCg0KY29uc3QgVmlzYW9ab25hc01vZGFsID0gKCkgPT4gaW1wb3J0KCcuLi9jb21wb25lbnRlcy9Nb2RhbFpvbmFzLnZ1ZScpOw0KY29uc3QgVmlzYW9ab25hc0l0ZW0gPSAoKSA9PiBpbXBvcnQoJy4uL2NvbXBvbmVudGVzL1pvbmFJdGVtLnZ1ZScpOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdWaXNhb1pvbmFzRmlsYScsDQogIGNvbXBvbmVudHM6IHsNCiAgICBMZWdlbmRhLA0KICAgIE5hdmVnYWNhbywNCiAgICBWaXNhb1pvbmFzTW9kYWwsDQogICAgVmlzYW9ab25hc0l0ZW0NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgem9uYVNlbGVjaW9uYWRhOiAnMScNCiAgICB9DQogIH0sDQogIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsNCiAgICBuZXh0KHZtID0+IHsNCiAgICAgIHZtLmF0dWFsaXphclZpc2FvKHRvLm5hbWUpOw0KICAgICAgdm0uYXR1YWxpemFyUG9sb1NlbGVjaW9uYWRvKDApOw0KICAgICAgdm0uYXR1YWxpemFyUG9sbGluZygpDQogICAgfSkNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAuLi5tYXBTdGF0ZSh7DQogICAgICB6b25hczogc3RhdGUgPT4gc3RhdGUuem9uYXMsDQogICAgICBldGFwYTogc3RhdGUgPT4gc3RhdGUuZXRhcGEsDQogICAgICBmaWxhOiBzdGF0ZSA9PiBzdGF0ZS5maWxhDQogICAgfSksDQogICAgLi4ubWFwR2V0dGVycyh7DQogICAgICBhbmRhbWVudG9zOiAnZ2V0QW5kYW1lbnRvcycNCiAgICB9KSwNCiAgICBlc3RhdGlzdGljYXMoKSB7DQogICAgICBpZiAodGhpcy5ldGFwYSA9PT0gMykgew0KICAgICAgICByZXR1cm4gJ0xpYmVyYWRhczogJyArIHRoaXMubGliZXJhZGFzDQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ0xpYmVyYWRhcyBob2plOiAnICsgdGhpcy5saWJlcmFkYXMgKyAnIGRlICcgKyB0aGlzLnpvbmFzT3JkZW5hZG8ubGVuZ3RoICsgJyAnICsgdGhpcy5wZXJjZW50dWFsTGliZXJhZGFzDQogICAgICB9DQogICAgfSwNCiAgICB6b25hc09yZGVuYWRvKCkgew0KICAgICAgY29uc3Qgc2FpZGEgPSBbXTsNCg0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZpbGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgY29uc3QgbnVtWm9uYSA9IHRoaXMuZmlsYVtpXS56b25hOw0KICAgICAgICBzYWlkYVtpXSA9IHRoaXMuem9uYXNBcnJheS5maW5kKHogPT4gKHoubnVtZXJvID09PSBudW1ab25hKSkNCiAgICAgIH0NCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy56b25hc0FycmF5Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmICh0aGlzLnpvbmFzQXJyYXlbaV0uc2l0dWFjYW9WZXJpZmljYWNhbyA9PT0gJ0FUSVZBJykgew0KICAgICAgICAgIGlmICghc2FpZGEuZmluZCh6ID0+IHoubnVtZXJvID09PSB0aGlzLnpvbmFzQXJyYXlbaV0ubnVtZXJvKSkgew0KICAgICAgICAgICAgc2FpZGEucHVzaCh0aGlzLnpvbmFzQXJyYXlbaV0pDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gbG9kYXNoLm9yZGVyQnkoc2FpZGEsDQogICAgICAgICAgWydzaXR1YWNhb1ZlcmlmaWNhY2FvJywgJ2FuZGFtZW50bycsICdwZW5kZW5jaWFzLmxlbmd0aCcsICdwZXJjUmVhbGl6YWRvJ10sIFsnYXNjJywgJ2FzYycsICdkZXNjJywgJ2FzYyddKQ0KICAgIH0sDQogICAgem9uYXNBcnJheSgpIHsNCiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuem9uYXMpDQogICAgfSwNCiAgICBwZXJjZW50dWFsTGliZXJhZGFzKCkgew0KICAgICAgaWYgKHRoaXMuem9uYXNPcmRlbmFkby5sZW5ndGggPT09IDApIHJldHVybiAnJzsNCiAgICAgIHJldHVybiAnKCcgKyAodGhpcy5saWJlcmFkYXMgLyB0aGlzLnpvbmFzT3JkZW5hZG8ubGVuZ3RoICogMTAwKS50b0ZpeGVkKCkgKyAnJSknDQogICAgfSwNCiAgICB0aXR1bG8oKSB7DQogICAgICByZXR1cm4gdGhpcy56b25hU2VsZWNpb25hZGEgKyAnIC0gJyArDQogICAgICAgICAgdGhpcy56b25hc1t0aGlzLnpvbmFTZWxlY2lvbmFkYV0ubXVuaWNpcGlvU2VkZQ0KICAgIH0sDQogICAgbGliZXJhZGFzKCkgew0KICAgICAgbGV0IGxpYmVyYWRhcyA9IDA7DQogICAgICBjb25zdCBhbmRhbWVudG9NYXhpbW8gPSB0aGlzLmFuZGFtZW50b3NbdGhpcy5hbmRhbWVudG9zLmxlbmd0aCAtIDFdLm51bWVybzsNCiAgICAgIGZvciAoY29uc3Qgem9uYSBvZiB0aGlzLnpvbmFzT3JkZW5hZG8pIHsNCiAgICAgICAgaWYgKHpvbmEuYW5kYW1lbnRvID09PSBhbmRhbWVudG9NYXhpbW8pIHsNCiAgICAgICAgICBsaWJlcmFkYXMrKw0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gbGliZXJhZGFzDQogICAgfSwNCiAgICBpdGVuc1Jlc3RhbnRlcygpIHsNCiAgICAgIGxldCBpdGVuc1Jlc3RhbnRlcyA9IDA7DQogICAgICBmb3IgKGNvbnN0IHpvbmEgaW4gdGhpcy56b25hcykgew0KICAgICAgICBpdGVuc1Jlc3RhbnRlcyArPSB0aGlzLnpvbmFzW3pvbmFdLml0ZW5zUmVzdGFudGVzDQogICAgICB9DQogICAgICByZXR1cm4gaXRlbnNSZXN0YW50ZXMNCiAgICB9LA0KICAgIGl0ZW5zVG90YWlzKCkgew0KICAgICAgbGV0IGl0ZW5zVG90YWlzID0gMDsNCiAgICAgIGZvciAoY29uc3Qgem9uYSBpbiB0aGlzLnpvbmFzKSB7DQogICAgICAgIGl0ZW5zVG90YWlzICs9IHRoaXMuem9uYXNbem9uYV0uaXRlbnNUb3RhaXMNCiAgICAgIH0NCiAgICAgIHJldHVybiBpdGVuc1RvdGFpcw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIC4uLm1hcEFjdGlvbnMoWw0KICAgICAgJ2F0dWFsaXphclBvbGxpbmcnDQogICAgXSksDQogICAgLi4ubWFwTXV0YXRpb25zKHsNCiAgICAgIGF0dWFsaXphclZpc2FvOiB0aXBvcy5BVFVBTElaQVJfVklTQU8sDQogICAgICBhdHVhbGl6YXJQb2xvU2VsZWNpb25hZG86IHRpcG9zLkFUVUFMSVpBUl9QT0xPX1NFTEVDSU9OQURPLA0KICAgICAgbW9zdHJhck1vZGFsOiB0aXBvcy5NT1NUUkFSX01PREFMX1pPTkENCiAgICB9KSwNCiAgICBtb3N0cmFyRGV0YWxoZXNab25hKG51bVpvbmEpIHsNCiAgICAgIHRoaXMubW9zdHJhck1vZGFsKHRydWUpOw0KICAgICAgdGhpcy56b25hU2VsZWNpb25hZGEgPSBudW1ab25hDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["VisaoZonasFila.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VisaoZonasFila.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <b-container fluid=\"true\">\r\n      <b-row align-v=\"start\">\r\n        <navegacao/>\r\n      </b-row>\r\n\r\n      <b-row class=\"faixa-informacoes\" style=\"width:100vw; padding-left: 1.8vw\" align-h=\"center\">\r\n        <div>{{ estatisticas }}</div>\r\n      </b-row>\r\n\r\n      <b-row id=\"lista-zonas\">\r\n        <visao-zonas-item v-for=\"zona in zonasOrdenado\" :key=\"zona.numero\" :zona=\"zona\"\r\n                          @zona-clicada=\"mostrarDetalhesZona(zona.numero)\"/>\r\n      </b-row>\r\n\r\n      <b-row id=\"legenda\">\r\n        <legenda/>\r\n      </b-row>\r\n\r\n      <visao-zonas-modal :zona=\"this.zonas[this.zonaSelecionada]\"/>\r\n    </b-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapActions, mapGetters, mapMutations, mapState} from 'vuex'\r\nimport * as tipos from '../store/mutationtypes'\r\n\r\nimport Navegacao from '../componentes/Navegacao'\r\nimport Legenda from '../componentes/Legenda'\r\nimport lodash from 'lodash'\r\n\r\nconst VisaoZonasModal = () => import('../componentes/ModalZonas.vue');\r\nconst VisaoZonasItem = () => import('../componentes/ZonaItem.vue');\r\n\r\nexport default {\r\n  name: 'VisaoZonasFila',\r\n  components: {\r\n    Legenda,\r\n    Navegacao,\r\n    VisaoZonasModal,\r\n    VisaoZonasItem\r\n  },\r\n  data() {\r\n    return {\r\n      zonaSelecionada: '1'\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    next(vm => {\r\n      vm.atualizarVisao(to.name);\r\n      vm.atualizarPoloSelecionado(0);\r\n      vm.atualizarPolling()\r\n    })\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      zonas: state => state.zonas,\r\n      etapa: state => state.etapa,\r\n      fila: state => state.fila\r\n    }),\r\n    ...mapGetters({\r\n      andamentos: 'getAndamentos'\r\n    }),\r\n    estatisticas() {\r\n      if (this.etapa === 3) {\r\n        return 'Liberadas: ' + this.liberadas\r\n      } else {\r\n        return 'Liberadas hoje: ' + this.liberadas + ' de ' + this.zonasOrdenado.length + ' ' + this.percentualLiberadas\r\n      }\r\n    },\r\n    zonasOrdenado() {\r\n      const saida = [];\r\n\r\n      for (let i = 0; i < this.fila.length; i++) {\r\n        const numZona = this.fila[i].zona;\r\n        saida[i] = this.zonasArray.find(z => (z.numero === numZona))\r\n      }\r\n      for (let i = 0; i < this.zonasArray.length; i++) {\r\n        if (this.zonasArray[i].situacaoVerificacao === 'ATIVA') {\r\n          if (!saida.find(z => z.numero === this.zonasArray[i].numero)) {\r\n            saida.push(this.zonasArray[i])\r\n          }\r\n        }\r\n      }\r\n      return lodash.orderBy(saida,\r\n          ['situacaoVerificacao', 'andamento', 'pendencias.length', 'percRealizado'], ['asc', 'asc', 'desc', 'asc'])\r\n    },\r\n    zonasArray() {\r\n      return Object.values(this.zonas)\r\n    },\r\n    percentualLiberadas() {\r\n      if (this.zonasOrdenado.length === 0) return '';\r\n      return '(' + (this.liberadas / this.zonasOrdenado.length * 100).toFixed() + '%)'\r\n    },\r\n    titulo() {\r\n      return this.zonaSelecionada + ' - ' +\r\n          this.zonas[this.zonaSelecionada].municipioSede\r\n    },\r\n    liberadas() {\r\n      let liberadas = 0;\r\n      const andamentoMaximo = this.andamentos[this.andamentos.length - 1].numero;\r\n      for (const zona of this.zonasOrdenado) {\r\n        if (zona.andamento === andamentoMaximo) {\r\n          liberadas++\r\n        }\r\n      }\r\n      return liberadas\r\n    },\r\n    itensRestantes() {\r\n      let itensRestantes = 0;\r\n      for (const zona in this.zonas) {\r\n        itensRestantes += this.zonas[zona].itensRestantes\r\n      }\r\n      return itensRestantes\r\n    },\r\n    itensTotais() {\r\n      let itensTotais = 0;\r\n      for (const zona in this.zonas) {\r\n        itensTotais += this.zonas[zona].itensTotais\r\n      }\r\n      return itensTotais\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapActions([\r\n      'atualizarPolling'\r\n    ]),\r\n    ...mapMutations({\r\n      atualizarVisao: tipos.ATUALIZAR_VISAO,\r\n      atualizarPoloSelecionado: tipos.ATUALIZAR_POLO_SELECIONADO,\r\n      mostrarModal: tipos.MOSTRAR_MODAL_ZONA\r\n    }),\r\n    mostrarDetalhesZona(numZona) {\r\n      this.mostrarModal(true);\r\n      this.zonaSelecionada = numZona\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.faixa-informacoes {\r\n  background-color: rgb(45, 139, 0);\r\n  font-size: calc(7px + 1.1vmin);\r\n  padding: 0.3vmin;\r\n  color: white;\r\n}\r\n\r\n#lista-zonas {\r\n  padding-top: calc(1 * (1vw + 1vh - 1vmin));\r\n  padding-left: calc(1.5 * (1vw + 1vh - 1vmin));\r\n  height: 100%\r\n}\r\n</style>\r\n"]}]}