{"remainingRequest":"/Users/leonardo/sape2020/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/leonardo/sape2020/src/views/VisaoMunicipios.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/leonardo/sape2020/src/views/VisaoMunicipios.vue","mtime":1598581088003},{"path":"/Users/leonardo/sape2020/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leonardo/sape2020/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/leonardo/sape2020/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/leonardo/sape2020/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgKiBhcyB0aXBvcyBmcm9tICcuLi9zdG9yZS9tdXRhdGlvbnR5cGVzJw0KaW1wb3J0IHttYXBBY3Rpb25zLCBtYXBHZXR0ZXJzLCBtYXBNdXRhdGlvbnMsIG1hcFN0YXRlfSBmcm9tICd2dWV4Jw0KDQppbXBvcnQgTCBmcm9tICdsZWFmbGV0Jw0KaW1wb3J0IE5hdmVnYWNhbyBmcm9tICcuLi9jb21wb25lbnRlcy9OYXZlZ2FjYW8nDQppbXBvcnQgTGVnZW5kYSBmcm9tICcuLi9jb21wb25lbnRlcy9MZWdlbmRhJw0KDQppbXBvcnQgbWFwYSBmcm9tICcuLi9hc3NldHMvZ2VvL21hcGFtdW5pY2lwaW9zLmpzJw0KaW1wb3J0IG1hcGFub3JkZXN0ZSBmcm9tICcuLi9hc3NldHMvZ2VvL25vcmRlc3RlLmpzJw0KDQppbXBvcnQgVmlzYW9NdW5pY2lwaW9zTW9kYWwgZnJvbSAnLi4vY29tcG9uZW50ZXMvTW9kYWxNdW5pY2lwaW9zJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdWaXNhb011bmljaXBpb3MnLA0KICBjb21wb25lbnRzOiB7DQogICAgVmlzYW9NdW5pY2lwaW9zTW9kYWwsDQogICAgTGVnZW5kYSwNCiAgICBOYXZlZ2FjYW8NCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbXVuaWNpcGlvU2VsZWNpb25hZG86ICcyNjAwMDU0JywNCiAgICAgIG1hcGE6IG51bGwsDQogICAgICBjYW1hZGFHZW86IG51bGwsDQogICAgICBjYW1hZGFGdW5kbzogbnVsbCwNCiAgICAgIGNhbWFkYUZ1bmRvMjogbnVsbCwNCiAgICAgIGluZm86IG51bGwNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoew0KICAgICAgbXVuaWNpcGlvczogc3RhdGUgPT4gc3RhdGUubXVuaWNpcGlvcywNCiAgICAgIGV0YXBhOiBzdGF0ZSA9PiBzdGF0ZS5ldGFwYQ0KICAgIH0pLA0KICAgIC4uLm1hcEdldHRlcnMoew0KICAgICAgYW5kYW1lbnRvczogJ2dldEFuZGFtZW50b3MnLA0KICAgICAgY29yTXVuaWNpcGlvOiAnZ2V0Q29yTXVuaWNpcGlvJywNCiAgICAgIGFuZGFtZW50b3NFdGFwYTogJ2dldEFuZGFtZW50b3NFdGFwYU11bmljaXBpb3MnDQogICAgfSkNCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBhbmRhbWVudG9zRXRhcGEoKSB7DQogICAgICB0aGlzLmF0dWFsaXphck1hcGEoKQ0KICAgIH0NCiAgfSwNCiAgYmVmb3JlUm91dGVFbnRlcih0bywgZnJvbSwgbmV4dCkgew0KICAgIG5leHQodm0gPT4gew0KICAgICAgdm0uYXR1YWxpemFyVmlzYW8odG8ubmFtZSk7DQogICAgICB2bS5hdHVhbGl6YXJQb2xsaW5nKCk7DQogICAgICB2bS5hdHVhbGl6YXJNYXBhKCkNCiAgICB9KQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIGNvbnN0IG9wY29lc01hcGEgPSB7DQogICAgICB6b29tQ29udHJvbDogZmFsc2UsDQogICAgICBhdHRyaWJ1dGlvbkNvbnRyb2w6IGZhbHNlLA0KICAgICAgZHJhZ2dpbmc6IGZhbHNlLA0KICAgICAgem9vbVNuYXA6IDAuMSwNCiAgICAgIHpvb21EZWx0YTogMC4xDQogICAgfTsNCg0KICAgIGlmICh0aGlzLm1hcGEgPT09IG51bGwgfHwgdGhpcy5tYXBhID09PSB1bmRlZmluZWQpIHsNCiAgICAgIHRoaXMubWFwYSA9IEwubWFwKCdtYXBhLW11bmljaXBpb3MnLCBvcGNvZXNNYXBhKQ0KICAgIH0NCg0KICAgIGlmICh0aGlzLmNhbWFkYUZ1bmRvID09IG51bGwpIHsNCiAgICAgIHRoaXMuY2FtYWRhRnVuZG8gPSBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LnBuZz9hY2Nlc3NfdG9rZW49e2FjY2Vzc1Rva2VufScsIHsNCiAgICAgICAgaWQ6ICdtYXBib3gubGlnaHQnLA0KICAgICAgICBhY2Nlc3NUb2tlbjogJ3BrLmV5SjFJam9pYkdWdmJtRnlaRzluWVd4MllXOGlMQ0poSWpvaVkycHNkakZrWW1kaU1IRXlkVE52YnpZMGMzUnBjV1ZpZHlKOS5ULUNRWUt4TWlIaVB3czc5bkFqRVRnJw0KICAgICAgfSkuYWRkVG8odGhpcy5tYXBhKQ0KICAgIH0NCg0KICAgIGlmICh0aGlzLmNhbWFkYUZ1bmRvMiA9PSBudWxsKSB7DQogICAgICB0aGlzLmNhbWFkYUZ1bmRvMiA9IEwuZ2VvSlNPTihtYXBhbm9yZGVzdGUsIHsNCiAgICAgICAgc3R5bGU6IHtmaWxsQ29sb3I6ICd3aGl0ZScsIGNvbG9yOiAnZGFya2dyYXknLCB3ZWlnaHQ6IDF9DQogICAgICB9KS5hZGRUbyh0aGlzLm1hcGEpDQogICAgfQ0KDQogICAgaWYgKHRoaXMuY2FtYWRhR2VvID09IG51bGwpIHsNCiAgICAgIHRoaXMuY2FtYWRhR2VvID0gTC5nZW9KU09OKG1hcGEsIHsNCiAgICAgICAgc3R5bGU6IHRoaXMuZXN0aWxvLA0KICAgICAgICBvbkVhY2hGZWF0dXJlOiB0aGlzLmF0dWFsaXphckVsZW1lbnRvcw0KICAgICAgfSkuYWRkVG8odGhpcy5tYXBhKQ0KICAgIH0NCg0KICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMuY2FtYWRhR2VvLmdldEJvdW5kcygpOw0KICAgIGNvbnN0IHpvb20gPSB0aGlzLm1hcGEuZ2V0Qm91bmRzWm9vbShib3VuZHMpOw0KICAgIHRoaXMubWFwYS5zZXRab29tKHpvb20gLSAwLjIpOw0KICAgIHRoaXMubWFwYS5zZXRNaW5ab29tKHpvb20pOw0KICAgIHRoaXMubWFwYS5zZXRNYXhab29tKHpvb20pOw0KICAgIHRoaXMubWFwYS5maXRCb3VuZHMoYm91bmRzKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubWFwQWN0aW9ucyhbDQogICAgICAnYXR1YWxpemFyUG9sbGluZycNCiAgICBdKSwNCiAgICAuLi5tYXBNdXRhdGlvbnMoew0KICAgICAgICAgIGF0dWFsaXphclZpc2FvOiB0aXBvcy5BVFVBTElaQVJfVklTQU8sDQogICAgICAgICAgbW9zdHJhck1vZGFsOiB0aXBvcy5NT1NUUkFSX01PREFMX01VTklDSVBJTw0KICAgICAgICB9DQogICAgKSwNCiAgICBhdHVhbGl6YXJNYXBhKCkgew0KICAgICAgdGhpcy5jYW1hZGFHZW8ucmVtb3ZlKCk7DQoNCiAgICAgIHRoaXMuY2FtYWRhR2VvID0gTC5nZW9KU09OKG1hcGEsIHsNCiAgICAgICAgc3R5bGU6IHRoaXMuZXN0aWxvLA0KICAgICAgICBvbkVhY2hGZWF0dXJlOiB0aGlzLmF0dWFsaXphckVsZW1lbnRvcw0KICAgICAgfSkuYWRkVG8odGhpcy5tYXBhKTsNCg0KICAgICAgY29uc29sZS5sb2coJ01hcGEgYXR1YWxpemFkbycpDQogICAgfSwNCiAgICBtb3N0cmFyRGV0YWxoZXMoZSkgew0KICAgICAgdGhpcy5tdW5pY2lwaW9TZWxlY2lvbmFkbyA9IGUudGFyZ2V0LmZlYXR1cmUucHJvcGVydGllcy5DT0RJQkdFOw0KICAgICAgdGhpcy5tb3N0cmFyTW9kYWwodHJ1ZSkNCiAgICB9LA0KICAgIG9idGVyQ29yKGNvZEliZ2UpIHsNCiAgICAgIHJldHVybiB0aGlzLmNvck11bmljaXBpbyhjb2RJYmdlKSB8fCAnZ3JleScNCiAgICB9LA0KICAgIGVzdGlsbyhmZWF0dXJlKSB7DQogICAgICByZXR1cm4gew0KICAgICAgICBmaWxsQ29sb3I6IHRoaXMub2J0ZXJDb3IoZmVhdHVyZS5wcm9wZXJ0aWVzLkNPRElCR0UpLA0KICAgICAgICB3ZWlnaHQ6IDIsDQogICAgICAgIG9wYWNpdHk6IDEsDQogICAgICAgIGNvbG9yOiAnbGlnaHRncmF5JywNCiAgICAgICAgZmlsbE9wYWNpdHk6IDENCiAgICAgIH0NCiAgICB9LA0KICAgIGRlc3RhY2FyKGUpIHsNCiAgICAgIGNvbnN0IGxheWVyID0gZS50YXJnZXQ7DQogICAgICBjb25zdCBjb2RpZ28gPSBsYXllci5mZWF0dXJlLnByb3BlcnRpZXMuQ09ESUJHRTsNCiAgICAgIGxheWVyLnNldFN0eWxlKHsNCiAgICAgICAgd2VpZ2h0OiA1LA0KICAgICAgICBmaWxsT3BhY2l0eTogMQ0KICAgICAgfSk7DQoNCiAgICAgIGlmICghTC5Ccm93c2VyLmllICYmICFMLkJyb3dzZXIub3BlcmEgJiYgIUwuQnJvd3Nlci5lZGdlKSB7DQogICAgICAgIGxheWVyLmJyaW5nVG9Gcm9udCgpDQogICAgICB9DQoNCiAgICAgIHRoaXMuaW5mbyA9IEwucG9wdXAoew0KICAgICAgICBhdXRvUGFuOiBmYWxzZSwNCiAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLA0KICAgICAgICBhdXRvQ2xvc2U6IHRydWUsDQogICAgICAgIGNsYXNzTmFtZTogJ2VzdGlsby1wb3B1cC1tdW5pY2lwaW8nDQogICAgICB9KS5zZXRMYXRMbmcoWy03LCAtMzcuOF0pLm9wZW5Pbih0aGlzLm1hcGEpOw0KDQogICAgICBjb25zdCBtdW5pY2lwaW8gPSB0aGlzLm11bmljaXBpb3NbY29kaWdvXTsNCiAgICAgIHRoaXMuYXR1YWxpemFySW5mbyhtdW5pY2lwaW8ubm9tZSArICcgKFBPTE8gJyArIG11bmljaXBpby5udW1Qb2xvICsgJyknKQ0KICAgIH0sDQogICAgY2FuY2VsYXJEZXN0YXF1ZShlKSB7DQogICAgICB0aGlzLmNhbWFkYUdlby5yZXNldFN0eWxlKGUudGFyZ2V0KTsNCiAgICAgIGlmICh0aGlzLmluZm8pIHRoaXMuaW5mby5yZW1vdmUoKQ0KICAgIH0sDQogICAgYXR1YWxpemFyRWxlbWVudG9zKGZlYXR1cmUsIGxheWVyKSB7DQogICAgICBsYXllci5vbih7DQogICAgICAgIG1vdXNlb3ZlcjogdGhpcy5kZXN0YWNhciwNCiAgICAgICAgbW91c2VvdXQ6IHRoaXMuY2FuY2VsYXJEZXN0YXF1ZSwNCiAgICAgICAgY2xpY2s6IHRoaXMubW9zdHJhckRldGFsaGVzDQogICAgICB9KTsNCiAgICAgIGNvbnN0IGNvZGlnbyA9IGxheWVyLmZlYXR1cmUucHJvcGVydGllcy5DT0RJQkdFOw0KICAgICAgY29uc3QgbXVuaWNpcGlvID0gdGhpcy5tdW5pY2lwaW9zW2NvZGlnb107DQogICAgICBjb25zdCBwb250b1RyYW5taXNzYW9SZW1vdGEgPSBtdW5pY2lwaW8uc2VkZVB0cjsNCiAgICAgIGlmICh0aGlzLmV0YXBhID09PSA2ICYmIHBvbnRvVHJhbm1pc3Nhb1JlbW90YSkgew0KICAgICAgICBsYXllci5iaW5kVG9vbHRpcCgnVCcsIHsNCiAgICAgICAgICAgICAgcGVybWFuZW50OiB0cnVlLA0KICAgICAgICAgICAgICBkaXJlY3Rpb246ICdjZW50ZXInLA0KICAgICAgICAgICAgICBvcGFjaXR5OiAxLjANCiAgICAgICAgICAgIH0NCiAgICAgICAgKQ0KICAgICAgfQ0KICAgIH0sDQogICAgYXR1YWxpemFySW5mbyhjb250ZXVkbykgew0KICAgICAgdGhpcy5pbmZvLnNldENvbnRlbnQoY29udGV1ZG8pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["VisaoMunicipios.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"VisaoMunicipios.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <b-container fluid=\"true\">\r\n    <b-row align-v=\"start\">\r\n      <navegacao/>\r\n    </b-row>\r\n\r\n    <b-row id=\"mapa-municipios\" align-v=\"center\"/>\r\n\r\n    <b-row>\r\n      <legenda/>\r\n    </b-row>\r\n\r\n    <visao-municipios-modal :municipio=\"municipios[municipioSelecionado]\"/>\r\n  </b-container>\r\n</template>\r\n\r\n<script>\r\nimport * as tipos from '../store/mutationtypes'\r\nimport {mapActions, mapGetters, mapMutations, mapState} from 'vuex'\r\n\r\nimport L from 'leaflet'\r\nimport Navegacao from '../componentes/Navegacao'\r\nimport Legenda from '../componentes/Legenda'\r\n\r\nimport mapa from '../assets/geo/mapamunicipios.js'\r\nimport mapanordeste from '../assets/geo/nordeste.js'\r\n\r\nimport VisaoMunicipiosModal from '../componentes/ModalMunicipios'\r\n\r\nexport default {\r\n  name: 'VisaoMunicipios',\r\n  components: {\r\n    VisaoMunicipiosModal,\r\n    Legenda,\r\n    Navegacao\r\n  },\r\n  data() {\r\n    return {\r\n      municipioSelecionado: '2600054',\r\n      mapa: null,\r\n      camadaGeo: null,\r\n      camadaFundo: null,\r\n      camadaFundo2: null,\r\n      info: null\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      municipios: state => state.municipios,\r\n      etapa: state => state.etapa\r\n    }),\r\n    ...mapGetters({\r\n      andamentos: 'getAndamentos',\r\n      corMunicipio: 'getCorMunicipio',\r\n      andamentosEtapa: 'getAndamentosEtapaMunicipios'\r\n    })\r\n  },\r\n  watch: {\r\n    andamentosEtapa() {\r\n      this.atualizarMapa()\r\n    }\r\n  },\r\n  beforeRouteEnter(to, from, next) {\r\n    next(vm => {\r\n      vm.atualizarVisao(to.name);\r\n      vm.atualizarPolling();\r\n      vm.atualizarMapa()\r\n    })\r\n  },\r\n  mounted() {\r\n    const opcoesMapa = {\r\n      zoomControl: false,\r\n      attributionControl: false,\r\n      dragging: false,\r\n      zoomSnap: 0.1,\r\n      zoomDelta: 0.1\r\n    };\r\n\r\n    if (this.mapa === null || this.mapa === undefined) {\r\n      this.mapa = L.map('mapa-municipios', opcoesMapa)\r\n    }\r\n\r\n    if (this.camadaFundo == null) {\r\n      this.camadaFundo = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {\r\n        id: 'mapbox.light',\r\n        accessToken: 'pk.eyJ1IjoibGVvbmFyZG9nYWx2YW8iLCJhIjoiY2psdjFkYmdiMHEydTNvbzY0c3RpcWVidyJ9.T-CQYKxMiHiPws79nAjETg'\r\n      }).addTo(this.mapa)\r\n    }\r\n\r\n    if (this.camadaFundo2 == null) {\r\n      this.camadaFundo2 = L.geoJSON(mapanordeste, {\r\n        style: {fillColor: 'white', color: 'darkgray', weight: 1}\r\n      }).addTo(this.mapa)\r\n    }\r\n\r\n    if (this.camadaGeo == null) {\r\n      this.camadaGeo = L.geoJSON(mapa, {\r\n        style: this.estilo,\r\n        onEachFeature: this.atualizarElementos\r\n      }).addTo(this.mapa)\r\n    }\r\n\r\n    const bounds = this.camadaGeo.getBounds();\r\n    const zoom = this.mapa.getBoundsZoom(bounds);\r\n    this.mapa.setZoom(zoom - 0.2);\r\n    this.mapa.setMinZoom(zoom);\r\n    this.mapa.setMaxZoom(zoom);\r\n    this.mapa.fitBounds(bounds)\r\n  },\r\n  methods: {\r\n    ...mapActions([\r\n      'atualizarPolling'\r\n    ]),\r\n    ...mapMutations({\r\n          atualizarVisao: tipos.ATUALIZAR_VISAO,\r\n          mostrarModal: tipos.MOSTRAR_MODAL_MUNICIPIO\r\n        }\r\n    ),\r\n    atualizarMapa() {\r\n      this.camadaGeo.remove();\r\n\r\n      this.camadaGeo = L.geoJSON(mapa, {\r\n        style: this.estilo,\r\n        onEachFeature: this.atualizarElementos\r\n      }).addTo(this.mapa);\r\n\r\n      console.log('Mapa atualizado')\r\n    },\r\n    mostrarDetalhes(e) {\r\n      this.municipioSelecionado = e.target.feature.properties.CODIBGE;\r\n      this.mostrarModal(true)\r\n    },\r\n    obterCor(codIbge) {\r\n      return this.corMunicipio(codIbge) || 'grey'\r\n    },\r\n    estilo(feature) {\r\n      return {\r\n        fillColor: this.obterCor(feature.properties.CODIBGE),\r\n        weight: 2,\r\n        opacity: 1,\r\n        color: 'lightgray',\r\n        fillOpacity: 1\r\n      }\r\n    },\r\n    destacar(e) {\r\n      const layer = e.target;\r\n      const codigo = layer.feature.properties.CODIBGE;\r\n      layer.setStyle({\r\n        weight: 5,\r\n        fillOpacity: 1\r\n      });\r\n\r\n      if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {\r\n        layer.bringToFront()\r\n      }\r\n\r\n      this.info = L.popup({\r\n        autoPan: false,\r\n        closeButton: false,\r\n        autoClose: true,\r\n        className: 'estilo-popup-municipio'\r\n      }).setLatLng([-7, -37.8]).openOn(this.mapa);\r\n\r\n      const municipio = this.municipios[codigo];\r\n      this.atualizarInfo(municipio.nome + ' (POLO ' + municipio.numPolo + ')')\r\n    },\r\n    cancelarDestaque(e) {\r\n      this.camadaGeo.resetStyle(e.target);\r\n      if (this.info) this.info.remove()\r\n    },\r\n    atualizarElementos(feature, layer) {\r\n      layer.on({\r\n        mouseover: this.destacar,\r\n        mouseout: this.cancelarDestaque,\r\n        click: this.mostrarDetalhes\r\n      });\r\n      const codigo = layer.feature.properties.CODIBGE;\r\n      const municipio = this.municipios[codigo];\r\n      const pontoTranmissaoRemota = municipio.sedePtr;\r\n      if (this.etapa === 6 && pontoTranmissaoRemota) {\r\n        layer.bindTooltip('T', {\r\n              permanent: true,\r\n              direction: 'center',\r\n              opacity: 1.0\r\n            }\r\n        )\r\n      }\r\n    },\r\n    atualizarInfo(conteudo) {\r\n      this.info.setContent(conteudo)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n#mapa-municipios {\r\n  height: 88vh;\r\n  z-index: 1;\r\n}\r\n\r\n</style>\r\n"]}]}